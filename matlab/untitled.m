A=[0 0 1 0;0 0 0 1;0 -0.1134104046 0 0;0 6.615606936 0 0];
T = 0.151135504765592;
F = diag([-1,-2,-1.5, -0.5]);
Fd = diag([0.5, 0.8, 0.3, 0.2]);
Ad = [
  1.0, -0.00131165, 0.1511355, -0.00006574791;
   0,    1.076513,         0,      0.1549708;
   0,  -0.0175753,       1.0,    -0.00131165;
   0,    1.025226,         0,       1.076513;
];
C = [1, -1,0,0];
G = [1,1,1,1];
Bg = [0.000033126; -0.000021975; 0.00043842; -0.00029444];
B=[0; 0; 0.00289017; -0.00192678];

I = eye(4); 

W = kron(I, A) - kron(F.', I);

Wd = kron(I, Ad) - kron(Fd.', I);


E = B * G;
Ed = Bg * G;

e = [E(:,1)', E(:,2)', E(:,3)', E(:,4)']';
ed = [Ed(:,1)', Ed(:,2)', Ed(:,3)', Ed(:,4)']';
p = linsolve(W,e)
P = [p(1:4), p(5:8), p(9:12), p(13:16)]

pd = linsolve(W_d,ed)
Pd = [pd(1:4), pd(5:8), pd(9:12), pd(13:16)]

kp=G/P
kdp=G/Pd

Az = A-b*kp
Adz = Ad-bd*kdp
eigAz = eig(Az)
eigAdz = eig(Adz)
sysZ =ss(Az,b,C,0);
sysZd=ss(Adz,bd,C,0, T);
