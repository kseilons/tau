% Задаем матрицы
Ad = [1.0, -0.00131165, 0.1511355, -0.00006574791;
      0, 1.076513, 0, 0.1549708;
      0, -0.0175753, 1.0, -0.00131165;
      0, 1.025226, 0, 1.076513];

Bd = [0.000033126;
      -0.000021975;
      0.00043842;
      -0.00029444];

Cd = [1, 0, 0, 0];

% Создадим дискретную модель состояния
sys_d = ss(Ad, Bd, Cd, 0, 'InputDelay', 0); 

% Параметры частот
omega = logspace(-2, 2, 500);  % Частоты от 0.01 до 100 радиан/с

% Получение АЧХ и ФЧХ
[mag, phase, w] = bode(sys_d, omega);

% Извлекаем данные из массива
mag = squeeze(mag);  % Упрощаем размерность
phase = squeeze(phase);

% Построение графиков
figure;

% Амплитудно-частотная характеристика
subplot(2, 1, 1);
semilogx(w, 20*log10(mag));  % Переводим в децибелы
grid on;
title('Амплитудно-частотная характеристика (АЧХ)');
xlabel('Частота (рад/с)');
ylabel('Амплитуда (дБ)');
