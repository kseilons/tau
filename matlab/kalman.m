format long
A=[0 0 1 0;0 0 0 1;0 -0.1134104046 0 0;0 6.615606936 0 0];
b=[0; 0; 0.00289017; -0.00192678];
C=[1 0 0 0];d=0;
Ad = [
  1.0, -0.00131165, 0.1511355, -0.00006574791;
   0,    1.076513,         0,      0.1549708;
   0,  -0.0175753,       1.0,    -0.00131165;
   0,    1.025226,         0,       1.076513;
];
bd = [
   0.000033126;
   -0.000021975;
   0.00043842;
  -0.00029444
];
Cd=[1 0 0 0];D=0;

S_y = [b, A*b, A^2*b, A^3*b]
Sd_y = [bd, Ad*bd, Ad^2*bd, Ad^3*bd]
rank_S_y = rank(S_y)
rank_Sd_y = rank(Sd_y)
S_H = [C', A'*C', A'^2*C', A'^3*C']
Sd_H = [Cd', Ad'*Cd', Ad'^2*Cd', Ad'^3*Cd']
rank_S_H = rank(S_H)
rank_Sd_H = rank(Sd_H)